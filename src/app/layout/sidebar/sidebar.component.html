
    <nav class="h-full flex flex-col py-5 pl-4 pr-2 bg-white/80 border-r border-slate-200/60 backdrop-blur-xl w-64 shrink-0 shadow-[4px_0_24px_rgba(0,0,0,0.02)] z-50">
      
      <!-- Brand -->
      <div class="px-2 mb-8 flex items-center gap-3 select-none">
        <div class="w-9 h-9 rounded-xl bg-gradient-to-br from-teal-500 to-emerald-600 flex items-center justify-center text-white font-bold text-lg shadow-lg shadow-teal-500/20 ring-1 ring-white/20">
          T
        </div>
        <div class="flex flex-col">
           <span class="font-bold text-lg tracking-tight text-slate-800 leading-none">Thuraya</span>
           <span class="text-[10px] font-medium text-slate-400 tracking-wide uppercase mt-0.5">Pharmacy OS</span>
        </div>
      </div>

      <!-- Menu Scroll Area -->
      <div class="flex-1 overflow-y-auto space-y-1 pr-2 custom-scrollbar">
        
        <!-- Dashboard -->
        <button 
          (click)="setView('dashboard')" 
          class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group relative"
          [class.bg-teal-50]="isActive('dashboard')" 
          [class.text-teal-700]="isActive('dashboard')"
          [class.text-slate-600]="!isActive('dashboard')" 
          [class.hover:bg-slate-50]="!isActive('dashboard')"
        >
          <app-icon name="layout-grid" [size]="18" [class]="isActive('dashboard') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
          Dashboard
        </button>

        <!-- Inventory -->
        <button 
          (click)="setView('inventory')" 
          class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group relative"
          [class.bg-teal-50]="isActive('inventory')" 
          [class.text-teal-700]="isActive('inventory')"
          [class.text-slate-600]="!isActive('inventory')" 
          [class.hover:bg-slate-50]="!isActive('inventory')"
        >
          <app-icon name="package" [size]="18" [class]="isActive('inventory') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
          Inventory
        </button>

        <!-- Procurement Group -->
        <div class="pt-1">
           <button 
             (click)="handleGroupClick('procurement')" 
             class="w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group"
             [class.text-teal-800]="isParentActive('procurement')"
             [class.bg-slate-50]="isParentActive('procurement') && !isGroupOpen('procurement')"
             [class.text-slate-600]="!isParentActive('procurement')"
             [class.hover:bg-slate-50]="!isParentActive('procurement')"
           >
             <div class="flex items-center gap-3">
               <app-icon name="briefcase" [size]="18" [class]="isParentActive('procurement') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
               Procurement
             </div>
             <app-icon name="chevron-down" [size]="14" class="text-slate-300 transition-transform duration-300" [class.rotate-180]="isGroupOpen('procurement')"></app-icon>
           </button>
           
           @if (isGroupOpen('procurement')) {
             <div class="flex flex-col gap-0.5 mt-1 ml-4 pl-3 border-l-2 border-slate-100 animate-slide-down origin-top">
               <button (click)="setView('procurement-orders')" 
                  class="w-full flex items-center gap-2 px-3 py-2 rounded-lg text-[13px] transition-colors"
                  [class]="isActive('procurement-orders') ? 'text-teal-700 bg-teal-50/50 font-semibold' : 'text-slate-500 hover:text-slate-800 hover:bg-slate-50'">
                 Orders
               </button>
               <button (click)="setView('procurement-bills')" 
                  class="w-full flex items-center gap-2 px-3 py-2 rounded-lg text-[13px] transition-colors"
                  [class]="isActive('procurement-bills') ? 'text-teal-700 bg-teal-50/50 font-semibold' : 'text-slate-500 hover:text-slate-800 hover:bg-slate-50'">
                 Bills & Payments
               </button>
               <button (click)="setView('procurement-suppliers')" 
                  class="w-full flex items-center gap-2 px-3 py-2 rounded-lg text-[13px] transition-colors"
                  [class]="isActive('procurement-suppliers') ? 'text-teal-700 bg-teal-50/50 font-semibold' : 'text-slate-500 hover:text-slate-800 hover:bg-slate-50'">
                 Suppliers
               </button>
             </div>
           }
        </div>

        <!-- Sales Group -->
        <div class="pt-1">
           <button 
             (click)="handleGroupClick('sales')" 
             class="w-full flex items-center justify-between px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group"
             [class.text-teal-800]="isParentActive('sales')"
             [class.bg-slate-50]="isParentActive('sales') && !isGroupOpen('sales')"
             [class.text-slate-600]="!isParentActive('sales')"
             [class.hover:bg-slate-50]="!isParentActive('sales')"
           >
             <div class="flex items-center gap-3">
               <app-icon name="trending-up" [size]="18" [class]="isParentActive('sales') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
               Sales & CRM
             </div>
             <app-icon name="chevron-down" [size]="14" class="text-slate-300 transition-transform duration-300" [class.rotate-180]="isGroupOpen('sales')"></app-icon>
           </button>
           
           @if (isGroupOpen('sales')) {
             <div class="flex flex-col gap-0.5 mt-1 ml-4 pl-3 border-l-2 border-slate-100 animate-slide-down origin-top">
                <button (click)="setView('sales-customers')" 
                  class="w-full flex items-center gap-2 px-3 py-2 rounded-lg text-[13px] transition-colors"
                  [class]="isActive('sales-customers') ? 'text-teal-700 bg-teal-50/50 font-semibold' : 'text-slate-500 hover:text-slate-800 hover:bg-slate-50'">
                 Customers
               </button>
               <button (click)="setView('sales-invoices')" 
                  class="w-full flex items-center gap-2 px-3 py-2 rounded-lg text-[13px] transition-colors"
                  [class]="isActive('sales-invoices') ? 'text-teal-700 bg-teal-50/50 font-semibold' : 'text-slate-500 hover:text-slate-800 hover:bg-slate-50'">
                 Invoices
               </button>
             </div>
           }
        </div>

        <!-- Point of Sale -->
        <button 
          (click)="setView('pos')" 
          class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group relative mt-1"
          [class.bg-teal-50]="isActive('pos')" 
          [class.text-teal-700]="isActive('pos')"
          [class.text-slate-600]="!isActive('pos')" 
          [class.hover:bg-slate-50]="!isActive('pos')"
        >
          <app-icon name="shopping-cart" [size]="18" [class]="isActive('pos') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
          Point of Sale
        </button>

         <div class="pt-6 pb-2">
           <div class="h-px bg-slate-100 mx-3 mb-3"></div>
           <p class="px-3 text-[10px] uppercase font-bold text-slate-400 tracking-wider">Management</p>
         </div>

         <button 
          (click)="setView('finance')" 
          class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group relative"
          [class.bg-teal-50]="isActive('finance')" [class.text-teal-700]="isActive('finance')"
          [class.text-slate-600]="!isActive('finance')" [class.hover:bg-slate-50]="!isActive('finance')"
        >
          <app-icon name="credit-card" [size]="18" [class]="isActive('finance') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
          Finance
        </button>

         <button 
          (click)="setView('users')" 
          class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group relative"
          [class.bg-teal-50]="isActive('users')" [class.text-teal-700]="isActive('users')"
          [class.text-slate-600]="!isActive('users')" [class.hover:bg-slate-50]="!isActive('users')"
        >
          <app-icon name="users" [size]="18" [class]="isActive('users') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
          Team & Roles
        </button>

         <button 
          (click)="setView('settings')"
          class="w-full flex items-center gap-3 px-3 py-2.5 rounded-lg text-sm font-medium transition-all duration-200 group relative"
          [class.bg-teal-50]="isActive('settings')" [class.text-teal-700]="isActive('settings')"
          [class.text-slate-600]="!isActive('settings')" [class.hover:bg-slate-50]="!isActive('settings')"
        >
          <app-icon name="settings" [size]="18" [class]="isActive('settings') ? 'text-teal-600' : 'text-slate-400 group-hover:text-slate-600'"></app-icon>
          Settings
        </button>
      </div>

      <!-- User Footer -->
      <div class="mt-auto px-2 pt-4 border-t border-slate-100">
        <div class="flex items-center gap-2">
          <button (click)="setView('settings')" class="flex-1 flex items-center gap-3 p-2 rounded-xl hover:bg-slate-50 transition-colors group text-left">
            <div class="w-9 h-9 rounded-full bg-slate-100 overflow-hidden border border-slate-200 shadow-sm shrink-0">
              <img [src]="store.currentUser().avatar" alt="User" class="object-cover w-full h-full opacity-90 group-hover:opacity-100" />
            </div>
            <div class="flex-1 min-w-0">
              <p class="text-sm font-semibold text-slate-700 truncate group-hover:text-slate-900">{{ store.currentUser().name }}</p>
              <p class="text-xs text-slate-400 truncate">{{ store.tenant()?.name || 'No Org' }}</p>
            </div>
          </button>
          <button 
            (click)="logout()" 
            class="p-2 rounded-lg text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors"
            title="Logout"
          >
            <app-icon name="log-out" [size]="18"></app-icon>
          </button>
        </div>
      </div>
    </nav>
  
